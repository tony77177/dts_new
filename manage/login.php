<?php/** * Created by PhpStorm. * User: TONY * Date: 2016-10-18 * Time: 20:38 * 系统登录页面 */require_once('config.php');require_once('../class/common.class.php');require_once('../libraries/mysqli.class.php');if ($_POST['username'] != '' && $_POST['password'] != '') {    $username = filter_value_for_sql(stripslashes(trim($_POST['username'])));    $password = md5(filter_value_for_sql(stripslashes(trim(($_POST['password'])))));    $common = new Common($databaseinfo);    $result = $common->check_login($username, $password);    if ($result[0]) {        session_start();        $_SESSION['username'] = $username;        $common->add_log_info($username, $_SERVER["REMOTE_ADDR"],date('Y-m-d H:i:s', time()));        die('<script>window.location.href=\'index.php\';</script>');    } else {        die('fail');    }}//参数过滤function filter_value_for_sql($str){    $str = str_replace("and", "", $str);    $str = str_replace("execute", "", $str);    $str = str_replace("update", "", $str);    $str = str_replace("count", "", $str);    $str = str_replace("chr", "", $str);    $str = str_replace("mid", "", $str);    $str = str_replace("master", "", $str);    $str = str_replace("truncate", "", $str);    $str = str_replace("char", "", $str);    $str = str_replace("declare", "", $str);    $str = str_replace("select", "", $str);    $str = str_replace("create", "", $str);    $str = str_replace("delete", "", $str);    $str = str_replace("insert", "", $str);    $str = str_replace("'", "", $str);    $str = str_replace('"', "", $str);    $str = str_replace(" ", "", $str);    $str = str_replace("or", "", $str);    $str = str_replace("=", "", $str);    $str = str_replace(" ", "", $str);    return $str;}?>